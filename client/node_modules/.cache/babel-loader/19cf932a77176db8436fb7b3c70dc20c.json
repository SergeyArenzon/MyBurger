{"ast":null,"code":"import _objectSpread from \"/home/sergey/Dev/MyBurger/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\n// import * as actionTypes from \"./actionTypes\";\n// import axios from \"axios\";\n// export const authStart = () => {\n//     return {\n//         type: actionTypes.AUTH_START,\n//     };\n// };\n// export const authSuccess = (idToken, userId) => {\n//     return {\n//         type: actionTypes.AUTH_SUCCESS,\n//         token: idToken,\n//         userId: userId,\n//     };\n// };\n// export const authFail = (error) => {\n//     return {\n//         type: actionTypes.AUTH_FAIL,\n//         error: error,\n//     };\n// };\n// export const logout = () => {\n//     return {\n//         type: actionTypes.AUTH_LOGOUT,\n//     };\n// };\n// export const checkAuthTimeout = (expirationTime) => {\n//     return (dispatch) => {\n//         setTimeout(() => {\n//             dispatch(logout());\n//         }, expirationTime * 1000);\n//     };\n// };\n// export const auth = (email, password, isSignup) => {\n//     return (dispatch) => {\n//         dispatch(authStart());\n//         const authData = {\n//             email: email,\n//             password: password,\n//             returnSecureToken: true,\n//         };\n//         let url =\n//             \"https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyAFFfCTRipxD7F1H5c2T0TtG34d16RZbrQ\";\n//         if (!isSignup) {\n//             url =\n//                 \"https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyAFFfCTRipxD7F1H5c2T0TtG34d16RZbrQ\";\n//         }\n//         axios\n//             .post(url, authData)\n//             .then((response) => {\n//                 console.log(response);\n//                 dispatch(\n//                     authSuccess(response.data.idToken, response.data.localId)\n//                 );\n//                 dispatch(checkAuthTimeout(response.data.expiresIn));\n//             })\n//             .catch((err) => {\n//                 console.log(err.response);\n//                 dispatch(authFail(err.response));\n//             });\n//     };\n// };\nimport * as actionTypes from \"./actionTypes\";\nimport axios from \"axios\";\nimport { returnErrors } from \"./error\";\nimport { fetchOrders } from './order';\nvar proxy = '';\n\nif (process.env.NODE_ENV === \"development\") {\n  proxy = 'http://localhost:5000';\n}\n\nexport var login = function login(_ref) {\n  var email = _ref.email,\n      password = _ref.password;\n  return function (dispatch) {\n    dispatch({\n      type: actionTypes.USER_LOADING\n    });\n    var config = {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n    var body = JSON.stringify({\n      email: email,\n      password: password\n    });\n    axios.post(proxy + \"/auth\", body, config).then(function (res) {\n      var fixedData = _objectSpread({}, res.data, {\n        user: {\n          _id: res.data.user.id\n        }\n      });\n\n      delete fixedData[\"user[id]\"];\n      localStorage.setItem(\"token\", fixedData.token);\n      dispatch({\n        type: actionTypes.LOGIN_SUCCESS,\n        payload: fixedData\n      });\n    }).catch(function (err) {\n      dispatch(returnErrors(err.response.data, err.response.status, \"LOGIN_FAIL\"));\n      dispatch({\n        type: actionTypes.LOGIN_FAIL\n      });\n    });\n  };\n};\nexport var register = function register(_ref2) {\n  var name = _ref2.name,\n      email = _ref2.email,\n      password = _ref2.password;\n  return function (dispatch) {\n    dispatch({\n      type: actionTypes.USER_LOADING\n    });\n    var config = {\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    };\n    var body = JSON.stringify({\n      name: name,\n      email: email,\n      password: password\n    });\n    axios.post(proxy + \"/users/add\", body, config).then(function (res) {\n      localStorage.setItem(\"token\", res.data.token);\n      dispatch({\n        type: actionTypes.REGISTER_SUCCESS,\n        payload: res.data\n      });\n    }).catch(function (err) {\n      dispatch(returnErrors(err.response.data, err.response.status, \"REGISTER_FAIL\"));\n      dispatch({\n        type: actionTypes.REGISTER_FAIL\n      });\n    });\n  };\n};\nexport var logout = function logout() {\n  return {\n    type: actionTypes.LOGOUT_SUCCESS\n  };\n}; // Check token & load user\n\nexport var loadUser = function loadUser() {\n  return function (dispatch, getState) {\n    // User loading\n    dispatch({\n      type: actionTypes.USER_LOADING\n    });\n    axios.get(proxy + \"/auth/user\", tokenConfig(getState)).then(function (res) {\n      dispatch({\n        type: actionTypes.USER_LOADED,\n        payload: res.data\n      });\n    }).catch(function (err) {\n      dispatch(returnErrors(err.response.data, err.response.status));\n      dispatch({\n        type: actionTypes.AUTH_ERROR\n      });\n    });\n  };\n}; // Setup config/headers and token\n\nexport var tokenConfig = function tokenConfig(getState) {\n  // Get token from loaclStorage\n  var token = getState().auth.token; // Header\n\n  var config = {\n    headers: {\n      \"Content-type\": \"application/json\"\n    }\n  };\n\n  if (token) {\n    config.headers[\"x-auth-token\"] = token;\n  }\n\n  return config;\n};","map":{"version":3,"sources":["/home/sergey/Dev/MyBurger/client/src/store/actions/auth.js"],"names":["actionTypes","axios","returnErrors","fetchOrders","proxy","process","env","NODE_ENV","login","email","password","dispatch","type","USER_LOADING","config","headers","body","JSON","stringify","post","then","res","fixedData","data","user","_id","id","localStorage","setItem","token","LOGIN_SUCCESS","payload","catch","err","response","status","LOGIN_FAIL","register","name","REGISTER_SUCCESS","REGISTER_FAIL","logout","LOGOUT_SUCCESS","loadUser","getState","get","tokenConfig","USER_LOADED","AUTH_ERROR","auth"],"mappings":"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","sourcesContent":["// import * as actionTypes from \"./actionTypes\";\n// import axios from \"axios\";\n\n// export const authStart = () => {\n//     return {\n//         type: actionTypes.AUTH_START,\n//     };\n// };\n\n// export const authSuccess = (idToken, userId) => {\n//     return {\n//         type: actionTypes.AUTH_SUCCESS,\n//         token: idToken,\n//         userId: userId,\n//     };\n// };\n\n// export const authFail = (error) => {\n//     return {\n//         type: actionTypes.AUTH_FAIL,\n//         error: error,\n//     };\n// };\n\n// export const logout = () => {\n//     return {\n//         type: actionTypes.AUTH_LOGOUT,\n//     };\n// };\n\n// export const checkAuthTimeout = (expirationTime) => {\n//     return (dispatch) => {\n//         setTimeout(() => {\n//             dispatch(logout());\n//         }, expirationTime * 1000);\n//     };\n// };\n\n// export const auth = (email, password, isSignup) => {\n//     return (dispatch) => {\n//         dispatch(authStart());\n//         const authData = {\n//             email: email,\n//             password: password,\n//             returnSecureToken: true,\n//         };\n//         let url =\n//             \"https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyAFFfCTRipxD7F1H5c2T0TtG34d16RZbrQ\";\n//         if (!isSignup) {\n//             url =\n//                 \"https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyAFFfCTRipxD7F1H5c2T0TtG34d16RZbrQ\";\n//         }\n//         axios\n//             .post(url, authData)\n//             .then((response) => {\n//                 console.log(response);\n//                 dispatch(\n//                     authSuccess(response.data.idToken, response.data.localId)\n//                 );\n//                 dispatch(checkAuthTimeout(response.data.expiresIn));\n//             })\n//             .catch((err) => {\n//                 console.log(err.response);\n//                 dispatch(authFail(err.response));\n//             });\n//     };\n// };\n\nimport * as actionTypes from \"./actionTypes\";\nimport axios from \"axios\";\nimport { returnErrors } from \"./error\";\nimport {fetchOrders} from './order';\n\nlet proxy = '';\nif(process.env.NODE_ENV === \"development\") {\n    proxy = 'http://localhost:5000'\n}\n\nexport const login = ({ email, password }) => (dispatch) => {\n    dispatch({ type: actionTypes.USER_LOADING });\n    const config = {\n        headers: {\n            \"Content-Type\": \"application/json\",\n        },\n    };\n\n    const body = JSON.stringify({ email, password });\n    axios\n        .post(proxy + \"/auth\", body, config)\n        .then((res) => {\n            const fixedData = {\n                ...res.data,\n                user: { _id: res.data.user.id },\n            };\n\n            delete fixedData[\"user[id]\"];\n            localStorage.setItem(\"token\", fixedData.token);\n            dispatch({\n                type: actionTypes.LOGIN_SUCCESS,\n                payload: fixedData,\n            });\n        })\n        .catch((err) => {\n            dispatch(\n                returnErrors(\n                    err.response.data,\n                    err.response.status,\n                    \"LOGIN_FAIL\"\n                )\n            );\n            dispatch({\n                type: actionTypes.LOGIN_FAIL,\n            });\n        });\n};\n\nexport const register = ({ name, email, password }) => (dispatch) => {\n    dispatch({ type: actionTypes.USER_LOADING });\n\n    const config = {\n        headers: {\n            \"Content-Type\": \"application/json\",\n        },\n    };\n\n    const body = JSON.stringify({ name, email, password });\n    axios\n        .post(proxy + \"/users/add\", body, config)\n        .then((res) => {\n            localStorage.setItem(\"token\", res.data.token);\n            dispatch({\n                type: actionTypes.REGISTER_SUCCESS,\n                payload: res.data,\n            });\n        })\n        .catch((err) => {\n            dispatch(\n                returnErrors(\n                    err.response.data,\n                    err.response.status,\n                    \"REGISTER_FAIL\"\n                )\n            );\n            dispatch({\n                type: actionTypes.REGISTER_FAIL,\n            });\n        });\n};\n\nexport const logout = () => {\n    return {\n        type: actionTypes.LOGOUT_SUCCESS,\n    };\n};\n\n// Check token & load user\nexport const loadUser = () => (dispatch, getState) => {\n    // User loading\n    dispatch({ type: actionTypes.USER_LOADING });\n    \n    axios\n        .get(proxy + \"/auth/user\", tokenConfig(getState))\n        .then((res) => {\n            dispatch({\n                type: actionTypes.USER_LOADED,\n                payload: res.data,\n            });\n        })\n        .catch((err) => {\n\n            dispatch(returnErrors(err.response.data, err.response.status));\n            dispatch({ type: actionTypes.AUTH_ERROR });\n        });\n};\n\n// Setup config/headers and token\n\nexport const tokenConfig = (getState) => {\n    // Get token from loaclStorage\n    const token = getState().auth.token;\n\n    // Header\n\n    const config = {\n        headers: {\n            \"Content-type\": \"application/json\",\n        },\n    };\n    if (token) {\n        config.headers[\"x-auth-token\"] = token;\n    }\n    return config;\n};\n"]},"metadata":{},"sourceType":"module"}