{"ast":null,"code":"// import * as actionTypes from \"./actionTypes\";\n// import axios from \"axios\";\n// export const authStart = () => {\n//     return {\n//         type: actionTypes.AUTH_START,\n//     };\n// };\n// export const authSuccess = (idToken, userId) => {\n//     return {\n//         type: actionTypes.AUTH_SUCCESS,\n//         token: idToken,\n//         userId: userId,\n//     };\n// };\n// export const authFail = (error) => {\n//     return {\n//         type: actionTypes.AUTH_FAIL,\n//         error: error,\n//     };\n// };\n// export const logout = () => {\n//     return {\n//         type: actionTypes.AUTH_LOGOUT,\n//     };\n// };\n// export const checkAuthTimeout = (expirationTime) => {\n//     return (dispatch) => {\n//         setTimeout(() => {\n//             dispatch(logout());\n//         }, expirationTime * 1000);\n//     };\n// };\n// export const auth = (email, password, isSignup) => {\n//     return (dispatch) => {\n//         dispatch(authStart());\n//         const authData = {\n//             email: email,\n//             password: password,\n//             returnSecureToken: true,\n//         };\n//         let url =\n//             \"https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyAFFfCTRipxD7F1H5c2T0TtG34d16RZbrQ\";\n//         if (!isSignup) {\n//             url =\n//                 \"https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyAFFfCTRipxD7F1H5c2T0TtG34d16RZbrQ\";\n//         }\n//         axios\n//             .post(url, authData)\n//             .then((response) => {\n//                 console.log(response);\n//                 dispatch(\n//                     authSuccess(response.data.idToken, response.data.localId)\n//                 );\n//                 dispatch(checkAuthTimeout(response.data.expiresIn));\n//             })\n//             .catch((err) => {\n//                 console.log(err.response);\n//                 dispatch(authFail(err.response));\n//             });\n//     };\n// };\nimport * as actionTypes from \"./actionTypes\";\nimport axios from \"axios\";\nimport { returnErrors } from \"./error\";\nexport var register = function register(_ref) {\n  var _ref$name = _ref.name,\n      name = _ref$name === void 0 ? 'some name' : _ref$name,\n      email = _ref.email,\n      password = _ref.password;\n  return function (dispatch) {\n    var config = {\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    };\n    var body = JSON.stringify({\n      name: name,\n      email: email,\n      password: password\n    });\n    axios.post(\"http://localhost:5000/users/add\", body, config).then(function (res) {\n      return dispatch({\n        type: actionTypes.REGISTER_SUCCESS,\n        payload: res.data\n      });\n    }).catch(function (err) {\n      dispatch(returnErrors(err.response.data, err.response.status));\n      dispatch({\n        type: actionTypes.REGISTER_FAIL\n      });\n    });\n  };\n}; // Check token & load user\n\nexport var loadUser = function loadUser() {\n  return function (dispatch, getState) {\n    // User loading\n    dispatch({\n      type: actionTypes.USER_LOADING\n    });\n    axios.get(\"http://localhost:5000/auth/user\", tokenConfig).then(function (res) {\n      dispatch({\n        type: actionTypes.USER_LOADED,\n        payload: res.data\n      });\n    }).catch(function (err) {\n      dispatch(returnErrors(err.response.data, err.response.status));\n      dispatch({\n        type: actionTypes.AUTH_ERROR\n      });\n    });\n  };\n}; // Setup config/headers and token\n\nexport var tokenConfig = function tokenConfig(getState) {\n  // Get token from loaclStorage\n  var token = getState().auth.token; // Header\n\n  var config = {\n    headers: {\n      \"Content-type\": \"application/json\"\n    }\n  };\n\n  if (token) {\n    config.headers[\"x-auth-token\"] = token;\n  }\n\n  return config;\n};","map":{"version":3,"sources":["/home/sergey/Dev/Web/myburger/src/store/actions/auth.js"],"names":["actionTypes","axios","returnErrors","register","name","email","password","dispatch","config","headers","body","JSON","stringify","post","then","res","type","REGISTER_SUCCESS","payload","data","catch","err","response","status","REGISTER_FAIL","loadUser","getState","USER_LOADING","get","tokenConfig","USER_LOADED","AUTH_ERROR","token","auth"],"mappings":"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","sourcesContent":["// import * as actionTypes from \"./actionTypes\";\n// import axios from \"axios\";\n\n// export const authStart = () => {\n//     return {\n//         type: actionTypes.AUTH_START,\n//     };\n// };\n\n// export const authSuccess = (idToken, userId) => {\n//     return {\n//         type: actionTypes.AUTH_SUCCESS,\n//         token: idToken,\n//         userId: userId,\n//     };\n// };\n\n// export const authFail = (error) => {\n//     return {\n//         type: actionTypes.AUTH_FAIL,\n//         error: error,\n//     };\n// };\n\n// export const logout = () => {\n//     return {\n//         type: actionTypes.AUTH_LOGOUT,\n//     };\n// };\n\n// export const checkAuthTimeout = (expirationTime) => {\n//     return (dispatch) => {\n//         setTimeout(() => {\n//             dispatch(logout());\n//         }, expirationTime * 1000);\n//     };\n// };\n\n// export const auth = (email, password, isSignup) => {\n//     return (dispatch) => {\n//         dispatch(authStart());\n//         const authData = {\n//             email: email,\n//             password: password,\n//             returnSecureToken: true,\n//         };\n//         let url =\n//             \"https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=AIzaSyAFFfCTRipxD7F1H5c2T0TtG34d16RZbrQ\";\n//         if (!isSignup) {\n//             url =\n//                 \"https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=AIzaSyAFFfCTRipxD7F1H5c2T0TtG34d16RZbrQ\";\n//         }\n//         axios\n//             .post(url, authData)\n//             .then((response) => {\n//                 console.log(response);\n//                 dispatch(\n//                     authSuccess(response.data.idToken, response.data.localId)\n//                 );\n//                 dispatch(checkAuthTimeout(response.data.expiresIn));\n//             })\n//             .catch((err) => {\n//                 console.log(err.response);\n//                 dispatch(authFail(err.response));\n//             });\n//     };\n// };\n\nimport * as actionTypes from \"./actionTypes\";\nimport axios from \"axios\";\nimport { returnErrors } from \"./error\";\n\n\n\nexport const register = ({name = 'some name', email, password}) => dispatch => {\n    const config = {\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    }\n\n    const body = JSON.stringify({name, email, password});\n    axios.post(\"http://localhost:5000/users/add\", body, config)\n        .then(res => dispatch({\n            type: actionTypes.REGISTER_SUCCESS,\n            payload: res.data\n        }))\n        .catch(err => {\n            dispatch(returnErrors(err.response.data, err.response.status))\n            dispatch({\n                type: actionTypes.REGISTER_FAIL\n            })\n        })\n}\n\n\n// Check token & load user\nexport const loadUser = () => (dispatch, getState) => {\n    // User loading\n    dispatch({ type: actionTypes.USER_LOADING });\n\n    axios\n        .get(\"http://localhost:5000/auth/user\", tokenConfig)\n        .then((res) => {\n            dispatch({\n                type: actionTypes.USER_LOADED,\n                payload: res.data,\n            });\n        })\n        .catch((err) => {\n            dispatch(returnErrors(err.response.data, err.response.status));\n            dispatch({ type: actionTypes.AUTH_ERROR });\n        });\n};\n\n// Setup config/headers and token\n\nexport const tokenConfig = (getState) => {\n    // Get token from loaclStorage\n    const token = getState().auth.token;\n\n    // Header\n\n    const config = {\n        headers: {\n            \"Content-type\": \"application/json\",\n        },\n    };\n    if (token) {\n        config.headers[\"x-auth-token\"] = token;\n    }\n    return config;\n};\n"]},"metadata":{},"sourceType":"module"}